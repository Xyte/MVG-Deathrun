function ChatBox.IsColor(color)	return (type(color) == "table" and color.r and color.g and color.b)endfunction ChatBox.GetLastColor(linedata)	local color = color_white		for k, v in pairs(linedata.textdata) do		if ChatBox.IsColor(v) then			color = v		end	end		return colorendfunction ChatBox.WrapString( linedata, maxwidth )	surface.SetFont("ChatFont")		local linewidth = 0	local packedlines = {}	local linenumber = 1		table.insert( packedlines, { icon = linedata.icon, textdata = {} } )		for k, v in pairs(linedata.textdata) do		if type(v) == "string" then			local w, h = surface.GetTextSize(v)			linewidth = linewidth + w			if linewidth >= maxwidth then				local w, h = surface.GetTextSize(v)				linewidth = w				linenumber = linenumber + 1				table.insert(packedlines, {textdata = {ChatBox.GetLastColor(packedlines[linenumber-1])}})			end			end				if ChatBox.IsColor(v) then			table.insert(packedlines[linenumber].textdata, v)		end				if type(v) == "string" then			table.insert(packedlines[linenumber].textdata, v)		end	end		return packedlines		end